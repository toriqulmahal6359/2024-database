;WITH JobList_CTE AS (	SELECT J.JP_ID, CASE WHEN J.JobLang =2 THEN BJ.Title ELSE J.JobTitle END As JobTitle, J.ProceedToPublishDate, J.Deadline		, J.Verified, J.PublishDate, J.Closed, COUNT(1) OVER() As TotalJob, J.CVReceivingOptions, J.PostingDate		, CASE WHEN J.JobLang=2 And (select COUNT(1) from JobStepsLog_arc WHERE JP_ID = j.jp_id And StepNo IN (1,2,4) And IsBangla = 1)=3 THEN 1 ELSE 0 END As StepLog	FROM dbo_JOBPOSTINGS_arc J 		LEFT JOIN DBO_BNG_JOBPOSTINGS_arc BJ on j.jp_id=BJ.jp_id 	WHERE J.CP_ID = 20744 And J.Drafted = 0 And J.Deleted=0 And (J.RegionalJob <> 4 OR J.RegionalJob IS NULL)	GROUP BY J.JobLang, BJ.Title, J.JP_ID, J.JobTitle, J.ProceedToPublishDate, J.Deadline, J.Verified, J.PublishDate, J.Closed, J.CVReceivingOptions, J.PostingDate	ORDER BY J.ProceedToPublishDate DESC, J.JP_ID DESC offset 40 rows fetch next 20 rows only)SELECT J.JP_ID, J.JobTitle, J.ProceedToPublishDate, J.Deadline, COUNT(i.JP_ID) AS T	, COUNT(case when i.Viewed=1 And p.ApplyID IS NULL And (i.rejected = 0 OR i.rejected IS NULL) then 1 else null end) AS Viewed	, COUNT(case when p.levelStatus=1 and p.Rejected = 0 then 1 else null end) AS Shortlisted	, J.Verified, J.PublishDate, COUNT(CASE WHEN i.Score = 100 THEN i.ApplyID END) AS MatchCount	, COUNT(CASE WHEN i.p_date>= JLVD.ViewedOn THEN 1 ELSE null END) As NEW1, J.Closed, 0 As Interview, 0 As FinalList, 0 As Rejected, J.TotalJob	, COUNT(V.ApplyID) As TotalVDOInterviewInvited	, COUNT(CASE WHEN V.ApplyID IS NOT NULL And V.FinalSubmitted = 1 THEN V.ApplyID END) As TotalVDOSubmitted	, J.StepLog, NewSystem = (SELECT COUNT(1) FROM rp.TestSteps_arc WHERE JP_ID = J.JP_ID), II.intID	, CASE WHEN J.CVReceivingOptions LIKE '%1%' THEN 1 ELSE 0 END As ApplyOnline,  J.PostingDateFROM JobList_CTE J	LEFT JOIN dbo_job_inbox_arc i on j.jp_id=i.jp_id --and i.jp_id in (select jp_id from JobList_CTE)	LEFT JOIN rp.ApplicantProcess_arc p ON i.Applyid=p.applyid And p.LevelStatus=1	LEFT JOIN bdjCorporate..JobLastViewedDate JLVD ON JLVD.JP_ID=J.JP_ID	LEFT JOIN vdo.InterviewInfo_arc AS II on j.jp_id=ii.jp_id	LEFT JOIN vdo.InterviewApplicants_arc AS V ON II.intId = V.intId and v.applyid=i.applyidGROUP BY J.JP_ID, J.JobTitle, J.ProceedToPublishDate, J.Deadline, J.Verified, J.PublishDate, J.Closed, J.TotalJob, J.StepLog, II.intID--, TotalVDOInterviewInvited, TotalVDOSubmitted	, CASE WHEN J.CVReceivingOptions LIKE '%1%' THEN 1 ELSE 0 END,  J.PostingDateORDER BY J.ProceedToPublishDate DESC, J.JP_ID DESC