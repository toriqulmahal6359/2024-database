WITH cte1 AS (    SELECT DISTINCT p.id AS p_id    FROM bdjResumes.dbo.PERSONAL p     INNER JOIN bdjresumes.dbo.PersonalAccomplishments a ON p.id = a.p_id    INNER JOIN bdjresumes.pwd.PersonalInfo i ON p.id = i.p_id    INNER JOIN bdjresumes.dbo.UserOtherProfiles up ON p.id = up.P_ID    WHERE pheight IS NOT NULL AND pheight > 0        AND pweight IS NOT NULL AND pweight > 0        AND (i.DisabilityID IS NOT NULL OR i.DisabilityID != '')), cte2 AS (    SELECT         c1.p_id,         jp.cp_id,         ji.jp_id,         CASE WHEN jp.JobLang = 2 THEN bj.TITLE ELSE jp.JobTitle END AS [Job Title],        ROW_NUMBER() OVER (PARTITION BY c1.p_id ORDER BY jp.cp_id) AS RowNumber    FROM cte1 c1    INNER JOIN bdjcorporate.dbo.DBO_JOB_INBOX ji ON c1.p_id = ji.p_id    INNER JOIN bdjCorporate.dbo.DBO_JOBPOSTINGS jp ON ji.jp_id = jp.jp_id    LEFT JOIN bdjCorporate.dbo.DBO_BNG_JOBPOSTINGS bj ON bj.JP_ID = jp.JP_ID)SELECT *FROM cte2WHERE RowNumber = 1;
    